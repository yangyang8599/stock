1. 使用均线 (MA5)
优点：
均线 (如 MA5) 本身已经有一定的平滑作用，可以降低高频信号的干扰。
使用 MA5 可以在一定程度上消除随机噪音，使得数据更容易分析。
建议：
可以根据实际数据特性尝试不同的窗口大小（如 MA3、MA10 等），找到适合你的数据的平滑效果。
2. 进一步平滑 (高斯平滑或傅里叶变换)
高斯平滑：
优点：对高频噪音有很好的抑制作用，同时保持较强的信号完整性。
实现：通过 scipy.ndimage.gaussian_filter 或者 numpy 实现高斯平滑。
傅里叶变换：
优点：可以直接在频域中去除特定频段的噪音，比如设置一个低通滤波器去除高频分量。
挑战：傅里叶变换的实现需要一些参数调试，尤其是确定截止频率。
3. 寻找拐点（局部极值）
平滑后的数据更适合寻找局部极值。以下是常用的方法：

一阶导数法：
使用数据的一阶导数，找到零交点（从正变负为极大值，从负变正为极小值）。
numpy.gradient 可以计算导数，scipy.signal.argrelextrema 可以直接寻找局部极值。
二阶导数法：
如果一阶导数的变化过于平缓，可以计算二阶导数，并结合一阶导数的位置精确确定拐点。
滚动窗口法：
在一定窗口（如最近 240 个点）内比较值，判断是否为局部极值。
改进建议：
使用双滑动窗口法：

对原始数据使用一个小窗口（如 MA5）和一个大窗口（如 MA20）分别进行平滑。
比较小窗口与大窗口的偏离程度，可以更精确地确定局部趋势和拐点。
尝试小波变换：

相比傅里叶变换，小波变换可以在频域和时间域同时操作，适合检测短时趋势变化。
pywt 是一个处理小波变换的优秀 Python 库。
启发式算法：

如果数据波动较大，可以考虑一些启发式算法，比如设定动态阈值来过滤掉小幅度变化的拐点。